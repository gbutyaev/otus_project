# Crawler

## Общая логика проекта
- Инфраструктура. Исполнена при помощи инструментов packer, terraform,ansible,docker
- Приложение разворачивается в докер компоузе , образы собираются в gitlab-ci



# Настройка инфраструктуры
 ## packer
 Готовим образ ВМ `ubuntu 20.04` и деплоим его в YC  
 ## terraform  
 Разворачиваем две виртуальные машины на основе подготовленного образа   
ВМ `project-application` - исходники проекта и докерфайлы  
ВМ `project-gitlab` - gitlab сервер в контейнере  
 ## ansible    
Для ВМ ``project-gitlab`` используя роль устанавливаем обновления. Сам gitlab сервер пока установлен руками  

Для ВМ ``project-application`` используя роли обновляем пакеты, устанавливаем `docker,docker-compose, docker-runner`, добавляем исходные файлы нашего приложения ( для тестов ), написанные `dockerfile` и `docker-compose.yml` ( для деплоя)



# Тестирование и деплой приложения
Для деплоя приложения написан CI, который состоит из 2 этапов:
- **Тестирование** `docker-runner` выполняет юнит тесты на ВМ `project-application`
- **Cборка образов** `docker-runner` собирает 2 образа `crawler_backend` и `crawler_ui` из докер файлов и деплоит их в докер хаб  
 **Деплой** Необходимо зайти на ВМ `project-application` и поднять подготовленный `docker-compose` ( образы приложения скачиваются из докер хаба). В дальнейшем будет ci для этого этапа
 
 Проверить работоспособность приложения можно перейдя по адресу ВМ `project-application`: 
 `51.250.2.121:8000`

 
 Установка Gitlab : 
 
**http://51.250.9.77/**  
login -  root    
passowd -  hcQnasUAbKjGp0lk3EY26TCj2lmaFL7yqpeThvUeHf8=
 